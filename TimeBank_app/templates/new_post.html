{% extends 'base.html' %}
{% load static %}
<html lang="en">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="description" content="">
  <meta name="author" content="">

  <title>TimeBank</title>

  <!-- Bootstrap core CSS -->
  <link href="{% static 'vendor/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet">

  <!-- Custom styles for this template -->
  <link href="{% static 'css/scrolling-nav.css' %}" rel="stylesheet">
  <link href="{% static 'css/blog-post.css' %}" rel="stylesheet">
  <link href="{% static 'css/styles.css' %}" rel="stylesheet" />

  <!--JQuery TimePicker-->
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/timepicker/1.3.5/jquery.timepicker.min.css">
  
  
  
  
</head>

<style>
  @font-face {
  font-family: 'Pretendard-Regular';
  src: url('https://cdn.jsdelivr.net/gh/Project-Noonnu/noonfonts_2107@1.1/Pretendard-Regular.woff') format('woff');
  font-weight: 400;
  font-style: normal;
  line-height: 150%;
}
body{font-family: 'Pretendard-Regular';}
</style>


<body class="d-flex flex-column h-100" style="padding-top: 0px;">
    <main class="flex-shrink-0">

  <!-- Navigation-->
  
  {% block content %}
  <!-- Page header with logo and tagline-->
  <header class="py-5 bg-light border-bottom mb-4">
    <div class="container">
        <div class="text-center my-5">
            <h1 class="fw-bolder">시간 거래 등록</h1>
            <p class="lead mb-0"></p>
        </div>
    </div>
</header>

  <div class="row mt-5">
    <div class="col-12">
      
    </div>
  </div>

  <!-- Page Content -->
  <div class="container">

    <div class="row">

      <!-- Post Content Column -->
      <div class="col-lg-8">

        <!-- Title -->
        <h1 class="mt-4" style="color:mediumvioletred;">시간 거래 요청</h1>

        <!-- Author -->
        <p class="lead">
          by
          <a href="#">{{ request.user }}</a>
        </p>

        <hr>

        <!-- Date/Time -->
        <p>주고받고자 하는 작업에 대해 오른쪽의 양식에 맞게 내용을 작성해주세요.<br>
          내용 작성에 도움이 될 만한 이야기들을 적어주세요.</p>

        <hr>

        <!-- Comments Form -->
        <div class="card my-4">
          <h5 class="card-header"></h5>
          <div class="card-body">
            {% if user.is_authenticated %}
            <form name="form1" action="{% url 'create' %}" method="post" enctype="multipart/form-data">
              {% csrf_token %}
              <div class="form-group">
                <label for="date">연-월-일</label>
                <input type="date" class="form-control" name="date" id="date">
              </div>
             <div class="form-group">
                <label for="start_time">가능 시작 시간</label>
                <input class="form-control timepicker" name="start_time" id="start_time">
              </div>

              <div class="form-group">
                <label for="end_time">가능 끝 시간</label>
                <input class="form-control timepicker" name="end_time" id="end_time">
              </div>

              <div class="form-group">
                <label for="service">요청 분류</label>
                <select class="form-control" name="service" id="service">
                  <option>주고 싶어요</option>
                  <option>받고 싶어요</option>
                </select>
              </div>

              
                <div class="form-group">
                  <label for="location">봉사 장소</label>
                  <br>

                  <div class="input-group">
                    <input type="text" class="form-control" id="sample4_postcode" placeholder="우편번호">
                    <div class="input-group-append">
                      <input type="button" class="btn btn-outline-primary" onclick="sample4_execDaumPostcode()" value="우편번호 찾기" style="float: left;">
                    </div>
                  </div>
                  <br>
                  <div class="form-row">
                    <div class="col-7">
                      <input type="text" class="form-control" id="sample4_roadAddress" placeholder="도로명주소">
                    </div>
                    <div class="col">
                      <input type="text" class="form-control" id="sample4_jibunAddress" placeholder="지번주소">
                    </div>
                  </div>
                  <br>
                  <span id="guide" style="color:#999;display:none"></span>
                  <div class="form-row">
                    <div class="col-7">
                      <input type="text" class="form-control" id="sample4_detailAddress" placeholder="상세주소">
                    </div>
                    <div class="col">
                      <input type="text" class="form-control" id="sample4_extraAddress" placeholder="참고항목">
                    </div>
                  </div>
                </div>
                


          
             
              <div class="form-group">
                <label for="mainwork">대분류</label>
                <select class="form-control" name="first" onchange="firstChange();" size=1>
                  <option value=''>대분류 선택</option>
                  <option value=''>교육</option>
                  <option value=''>예술</option>
                  <option value=''>스포츠</option>
                  <option value=''>돌봄</option>
                  <option value=''>일손 제공</option>
                  <option value=''>언어</option>
                  <option value=''>멘토링/튜터링</option>
                  <option value=''>수리/수선</option>
                  <option value=''>사무</option>
                  <option value=''>반려동물</option>
                  <option value=''>기타</option>
                </select>
              </div>
              
              <div class="form-group">
                <label for="mainwork">중분류</label>
                  <select class="form-control" name="second" size=1>
                  <option value=''>대분류를 먼저 선택하세요</option>
                  </select>
              </div>
              
                

              <div class="form-group">
                <label for="subwork">소분류</label>
                <input type="text" class="form-control" id="subwork" name="subwork" placeholder="">
              </div> 

              <div class="form-group">
                <label for="tok">거래 시간 (단위:시간)</label>
                <input type="text" class="form-control" name="tok" id="tok" placeholder="" value=1>
              </div>

              <div class="form-group">
                <label for="image">이미지 등록</label>
                <input id="image" name="image" class="form-control" type="file">
              </div>

              <div class="form-group">
                <label for="content">요청 설명</label>
                <textarea class="form-control" name="content" id="content" rows="3"></textarea>
              </div>

              <button type="submit" class="btn btn-success">거래 등록</button>
              {% else %}
              <script type="text/javascript">
                alert('로그인 후, 이용하실 수 있습니다.')
                window.location.href = '{% url "login" %}';
              </script>
              {% endif %}
            </form>
          </div>
        </div>

      </div>

      <!-- Sidebar Widgets Column -->
      <div class="col-md-4">
        <div>
          <a href="{% url 'index' %}" class="btn btn-light">홈</a>/<a href="{% url 'post_list'%}" class="btn btn-light">거래목록</a>
        </div>

        <!-- Side Widget -->
        <div class="card my-4">
          <h5 class="card-header">문의사항</h5>
          <div class="card-body">
            031-408-1225
          </div>
        </div> 

      </div>

    </div>
    <!-- /.row -->

  </div>
  <!-- /.container -->
  

</main>  

<footer class="bg-dark py-4 mt-auto">
  <div class="container px-5">
      <div class="row align-items-center justify-content-between flex-column flex-sm-row">
          <div class="col-auto"><div class="small m-0 text-white">Copyright &copy; TimeBank 2021</div></div>
          <div class="col-auto">
              <a class="link-light small" href="#!">Privacy</a>
              <span class="text-white mx-1">&middot;</span>
              <a class="link-light small" href="#!">Terms</a>
              <span class="text-white mx-1">&middot;</span>
              <a class="link-light small" href="#!">Contact</a>
          </div>
      </div>
  </div>
</footer>

<!-- Bootstrap core JavaScript -->
<script src="{% static 'vendor/jquery/jquery.min.js' %}"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>


<!-- Plugin JavaScript -->
<script src="{% static 'vendor/jquery-easing/jquery.easing.min.js' %}"></script>

<!-- Custom JavaScript for this theme -->
<script src="{% static 'js/scripts.js' %}"></script>

  <!--JQuery TimePicker-->
  <script src="//cdnjs.cloudflare.com/ajax/libs/timepicker/1.3.5/jquery.timepicker.min.js"></script>

  <script>
    $(document).ready(function(){
      $('input.timepicker').timepicker({
        timeFormat: 'h:mm p',
        interval: 15,
        minTime: '7',
        maxTime: '11:59pm',
        startTime: '7:00',
        dynamic: false,
        dropdown: true,
        scrollbar: true
      })
    });

  </script>


<script>
  // 대분류 변한 경우
  function firstChange() {
     
    var x = document.form1.first.options.selectedIndex;    //선택한 인덱스
    var groups=document.form1.first.options.length;        //대분류 갯수
    var group=new Array(groups);     //배열 생성
     
    for (i=0; i<groups; i++) {
      group[i]=new Array();
    }

    // 옵션(<option>) 생성
    group[0][0]=new Option("대분류를 먼저 선택하세요","");

    // 교육
    group[1][0]=new Option("일대다 서로배움교실","");
    group[1][1]=new Option("각종 교육 제공","ss");       //결과 <option value="ss">삼성</option>
    group[1][2]=new Option("기타","dw");

    // 예술
    group[2][0]=new Option("공연","");
    group[2][1]=new Option("실기","epson");
    group[2][2]=new Option("레슨","hp");
    group[2][3]=new Option("명상","sb");
    group[2][4]=new Option("기타","sb");

    // 스포츠
    group[3][0]=new Option("구기 운동 함께하기","");
    group[3][1]=new Option("가르치기","epson");
    group[3][2]=new Option("기타","hp");

    // 돌봄
    group[4][0]=new Option("병원동행","");
    group[4][1]=new Option("말벗","epson");
    group[4][2]=new Option("산책","hp");
    group[4][3]=new Option("차량이동","sb");
    group[4][4]=new Option("복약알리미","sb");
    group[4][5]=new Option("기타","sb");
    
    // 일손 제공
    group[5][0]=new Option("심부름","");
    group[5][1]=new Option("장보기","epson");
    group[5][2]=new Option("배달","hp");
    group[5][3]=new Option("청소","sb");
    group[5][4]=new Option("조리","sb");
    group[5][5]=new Option("집정리","sb");
    group[5][6]=new Option("기타","sb");

    // 언어
    group[6][0]=new Option("외국어 통번역","");
    group[6][1]=new Option("한국어 지도","epson");
    group[6][2]=new Option("외국어 가르치기","hp");
    group[6][3]=new Option("기타","sb");

    // 멘토링튜터링
    group[7][0]=new Option("상담","");
    group[7][1]=new Option("학습지도","epson");
    group[7][2]=new Option("기타","hp");

    // 수리수선
    group[8][0]=new Option("컴퓨터","");
    group[8][1]=new Option("모바일폰","epson");
    group[8][2]=new Option("집","hp");
    group[8][3]=new Option("가구","hp");
    group[8][4]=new Option("장난감","hp");
    group[8][5]=new Option("자동차","hp");
    group[8][6]=new Option("기타","hp");

    // 사무
    group[9][0]=new Option("문서작성","");
    group[9][1]=new Option("편집","epson");
    group[9][2]=new Option("자료정리","hp");
    group[9][3]=new Option("사무보조","hp");
    group[9][4]=new Option("기타","hp");

    // 반려동물
    group[10][0]=new Option("돌봄","");
    group[10][1]=new Option("산책","epson");
    group[10][2]=new Option("음식조리","hp");
    group[10][3]=new Option("기타","hp");

    // 기타
    group[11][0]=new Option("기타","");


     temp = document.form1.second;      //두번 째 셀렉트 얻기(<select name=second>)
     for (m = temp.options.length-1 ; m > 0 ; m--) {    //현재 값 지우기
      temp.options[m]=null
     }
     for (i=0;i<group[x].length;i++){    //값 셋팅
      temp.options[i]=new Option(group[x][i].text,group[x][i].value);
     }
     temp.options[0].selected=true      //인덱스 0번째, 즉, 첫번째 선택
    }
    
    
    //  temp = document.form1.third;
    //  for (m = temp.options.length-1 ; m > 0 ; m--) {
    //   temp.options[m]=null
    //  }
    //  for (i=0;i<group[x].length;i++){
    //   temp.options[i]=new Option(group[x][i].text,group[x][i].value)
    //  }
    //  temp.options[0].selected=true
    // }
  </script>

<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
<script>
    //본 예제에서는 도로명 주소 표기 방식에 대한 법령에 따라, 내려오는 데이터를 조합하여 올바른 주소를 구성하는 방법을 설명합니다.
    function sample4_execDaumPostcode() {
        new daum.Postcode({
            oncomplete: function(data) {
                // 팝업에서 검색결과 항목을 클릭했을때 실행할 코드를 작성하는 부분.

                // 도로명 주소의 노출 규칙에 따라 주소를 표시한다.
                // 내려오는 변수가 값이 없는 경우엔 공백('')값을 가지므로, 이를 참고하여 분기 한다.
                var roadAddr = data.roadAddress; // 도로명 주소 변수
                var extraRoadAddr = ''; // 참고 항목 변수

                // 법정동명이 있을 경우 추가한다. (법정리는 제외)
                // 법정동의 경우 마지막 문자가 "동/로/가"로 끝난다.
                if(data.bname !== '' && /[동|로|가]$/g.test(data.bname)){
                    extraRoadAddr += data.bname;
                }
                // 건물명이 있고, 공동주택일 경우 추가한다.
                if(data.buildingName !== '' && data.apartment === 'Y'){
                   extraRoadAddr += (extraRoadAddr !== '' ? ', ' + data.buildingName : data.buildingName);
                }
                // 표시할 참고항목이 있을 경우, 괄호까지 추가한 최종 문자열을 만든다.
                if(extraRoadAddr !== ''){
                    extraRoadAddr = ' (' + extraRoadAddr + ')';
                }

                // 우편번호와 주소 정보를 해당 필드에 넣는다.
                document.getElementById('sample4_postcode').value = data.zonecode;
                document.getElementById("sample4_roadAddress").value = roadAddr;
                document.getElementById("sample4_jibunAddress").value = data.jibunAddress;
                
                // 참고항목 문자열이 있을 경우 해당 필드에 넣는다.
                if(roadAddr !== ''){
                    document.getElementById("sample4_extraAddress").value = extraRoadAddr;
                } else {
                    document.getElementById("sample4_extraAddress").value = '';
                }

                var guideTextBox = document.getElementById("guide");
                // 사용자가 '선택 안함'을 클릭한 경우, 예상 주소라는 표시를 해준다.
                if(data.autoRoadAddress) {
                    var expRoadAddr = data.autoRoadAddress + extraRoadAddr;
                    guideTextBox.innerHTML = '(예상 도로명 주소 : ' + expRoadAddr + ')';
                    guideTextBox.style.display = 'block';

                } else if(data.autoJibunAddress) {
                    var expJibunAddr = data.autoJibunAddress;
                    guideTextBox.innerHTML = '(예상 지번 주소 : ' + expJibunAddr + ')';
                    guideTextBox.style.display = 'block';
                } else {
                    guideTextBox.innerHTML = '';
                    guideTextBox.style.display = 'none';
                }
            }
        }).open();
    }
</script>

</body>
</html>
{% endblock %}
